{"ast":null,"code":"var _jsxFileName=\"/home/yuri/Freelance/Clients/Cheil/seace-qa/src/MapScreen.tsx\";import React,{useState,useEffect}from'react';import'./MapScreen.css';import{GoogleMap,Marker}from\"react-google-maps\";const{GoogleSpreadsheet}=require('google-spreadsheet');const doc=new GoogleSpreadsheet('1QtCGUCN-_xZPLYExN3btHeXphRi4VI-uGABA87cHj-M');const REGION_TO_SHEET_MAP={'uk':9};function MapScreen(){const[region,setRegion]=useState('uk');const[companies,setCompanies]=useState(null);const[loading,setLoading]=useState(false);const[searchLocation,setSearchLocation]=useState({lat:50.8742724,lon:0.6619475});const fetchGoogleSheet=async()=>{await doc.useServiceAccountAuth(require('./SEACE Installer Locator-5a80e6b026be.json'));};// const onSearch = async (query: string) => {\n//   const point = {lat: 51.5287714, lon: -0.2420237}\n//   // const point = GMaps.getLocation(query)\n// }\nconst fetchCompaniesForRegion=async region=>{try{setLoading(true);await doc.loadInfo();console.log(doc.title);const sheet=doc.sheetsByIndex[REGION_TO_SHEET_MAP['uk']];const rows=await sheet.getRows();setCompanies(rows);console.log(rows);setLoading(false);}catch(error){setLoading(false);console.error(error);}};// Only once\nuseEffect(()=>{fetchGoogleSheet();});// Every region change\nuseEffect(()=>{fetchCompaniesForRegion(region);},[region]);return/*#__PURE__*/React.createElement(\"div\",{className:\"map-screen\",__self:this,__source:{fileName:_jsxFileName,lineNumber:58,columnNumber:5}},/*#__PURE__*/React.createElement(GoogleMap,{defaultZoom:8,defaultCenter:{lat:-34.397,lng:150.644},__self:this,__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:7}},/*#__PURE__*/React.createElement(Marker,{position:{lat:-34.397,lng:150.644},__self:this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:9}})));}export default MapScreen;","map":{"version":3,"sources":["/home/yuri/Freelance/Clients/Cheil/seace-qa/src/MapScreen.tsx"],"names":["React","useState","useEffect","GoogleMap","Marker","GoogleSpreadsheet","require","doc","REGION_TO_SHEET_MAP","MapScreen","region","setRegion","companies","setCompanies","loading","setLoading","searchLocation","setSearchLocation","lat","lon","fetchGoogleSheet","useServiceAccountAuth","fetchCompaniesForRegion","loadInfo","console","log","title","sheet","sheetsByIndex","rows","getRows","error","lng"],"mappings":"iFAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAO,iBAAP,CAKA,OAASC,SAAT,CAAoBC,MAApB,KAAkC,mBAAlC,CAEA,KAAM,CAAEC,iBAAF,EAAwBC,OAAO,CAAC,oBAAD,CAArC,CAEA,KAAMC,CAAAA,GAAG,CAAG,GAAIF,CAAAA,iBAAJ,CAAsB,8CAAtB,CAAZ,CAEA,KAAMG,CAAAA,mBAAmB,CAAG,CAC1B,KAAM,CADoB,CAA5B,CAIA,QAASC,CAAAA,SAAT,EAAqB,CACnB,KAAM,CAACC,MAAD,CAASC,SAAT,EAAsBV,QAAQ,CAAS,IAAT,CAApC,CACA,KAAM,CAACW,SAAD,CAAYC,YAAZ,EAA4BZ,QAAQ,CAA8B,IAA9B,CAA1C,CACA,KAAM,CAACa,OAAD,CAAUC,UAAV,EAAwBd,QAAQ,CAAU,KAAV,CAAtC,CACA,KAAM,CAACe,cAAD,CAAiBC,iBAAjB,EAAsChB,QAAQ,CAAoC,CAACiB,GAAG,CAAE,UAAN,CAAkBC,GAAG,CAAE,SAAvB,CAApC,CAApD,CAEA,KAAMC,CAAAA,gBAAgB,CAAG,SAAY,CACnC,KAAMb,CAAAA,GAAG,CAACc,qBAAJ,CAA0Bf,OAAO,CAAC,6CAAD,CAAjC,CAAN,CACD,CAFD,CAIA;AACA;AACA;AACA;AAEA,KAAMgB,CAAAA,uBAAuB,CAAG,KAAOZ,CAAAA,MAAP,EAA0B,CACxD,GAAI,CACFK,UAAU,CAAC,IAAD,CAAV,CACA,KAAMR,CAAAA,GAAG,CAACgB,QAAJ,EAAN,CACAC,OAAO,CAACC,GAAR,CAAYlB,GAAG,CAACmB,KAAhB,EACA,KAAMC,CAAAA,KAAK,CAAGpB,GAAG,CAACqB,aAAJ,CAAkBpB,mBAAmB,CAAC,IAAD,CAArC,CAAd,CACA,KAAMqB,CAAAA,IAAI,CAAG,KAAMF,CAAAA,KAAK,CAACG,OAAN,EAAnB,CACAjB,YAAY,CAACgB,IAAD,CAAZ,CACAL,OAAO,CAACC,GAAR,CAAYI,IAAZ,EAEAd,UAAU,CAAC,KAAD,CAAV,CACD,CAAC,MAAOgB,KAAP,CAAc,CACdhB,UAAU,CAAC,KAAD,CAAV,CACAS,OAAO,CAACO,KAAR,CAAcA,KAAd,EACD,CACF,CAfD,CAiBA;AACA7B,SAAS,CAAC,IAAM,CAACkB,gBAAgB,GAAG,CAA3B,CAAT,CAEA;AACAlB,SAAS,CAAC,IAAM,CACdoB,uBAAuB,CAACZ,MAAD,CAAvB,CACD,CAFQ,CAEN,CAACA,MAAD,CAFM,CAAT,CAIA,mBACE,2BAAK,SAAS,CAAC,YAAf,yFAiBE,oBAAC,SAAD,EACE,WAAW,CAAE,CADf,CAEE,aAAa,CAAE,CAAEQ,GAAG,CAAE,CAAC,MAAR,CAAgBc,GAAG,CAAE,OAArB,CAFjB,yFAIE,oBAAC,MAAD,EAAQ,QAAQ,CAAE,CAAEd,GAAG,CAAE,CAAC,MAAR,CAAgBc,GAAG,CAAE,OAArB,CAAlB,4EAJF,CAjBF,CADF,CA2BD,CAED,cAAevB,CAAAA,SAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './MapScreen.css';\nimport { Filter } from './components/MapFilter'\nimport { MapLegend } from './components/MapLegend'\nimport { MapRegionIndicator } from './components/MapRegionIndicator';\nimport { CompanyLayout } from './interfaces';\nimport { GoogleMap, Marker } from \"react-google-maps\"\n\nconst { GoogleSpreadsheet } = require('google-spreadsheet');\n \nconst doc = new GoogleSpreadsheet('1QtCGUCN-_xZPLYExN3btHeXphRi4VI-uGABA87cHj-M');\n\nconst REGION_TO_SHEET_MAP = {\n  'uk': 9\n}\n\nfunction MapScreen() {\n  const [region, setRegion] = useState<string>('uk');\n  const [companies, setCompanies] = useState<Array<CompanyLayout> | null>(null)\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searchLocation, setSearchLocation] = useState<{lat: number, lon: number} | null>({lat: 50.8742724, lon: 0.6619475})\n\n  const fetchGoogleSheet = async () => {\n    await doc.useServiceAccountAuth(require('./SEACE Installer Locator-5a80e6b026be.json'));\n  }\n\n  // const onSearch = async (query: string) => {\n  //   const point = {lat: 51.5287714, lon: -0.2420237}\n  //   // const point = GMaps.getLocation(query)\n  // }\n\n  const fetchCompaniesForRegion = async (region: string) => {\n    try {\n      setLoading(true);\n      await doc.loadInfo();\n      console.log(doc.title);\n      const sheet = doc.sheetsByIndex[REGION_TO_SHEET_MAP['uk']]\n      const rows = await sheet.getRows();\n      setCompanies(rows);\n      console.log(rows);\n      \n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n      console.error(error);\n    }\n  }\n\n  // Only once\n  useEffect(() => {fetchGoogleSheet()});\n\n  // Every region change\n  useEffect(() => {\n    fetchCompaniesForRegion(region);\n  }, [region]);\n\n  return (\n    <div className=\"map-screen\">\n      {/* <iframe\n        width=\"100%\"\n        height=\"100%\"\n        style={{border:0}}\n        src=\"https://www.google.com/maps/embed/v1/place?key=API_KEY\n          &q=Space+Needle,Seattle+WA\">\n      </iframe> */}\n      {/* <GoogleMapReact\n        bootstrapURLKeys={{ key: 'gme-samsungsds' }}\n        defaultCenter={{lat: 59.95, lng: 30.33}}\n        defaultZoom={11}\n      > */}\n        {/* <Filter onSubmit={() => {}} loading={loading} companies={companies} searchLocation={searchLocation}/>\n        <MapLegend isOpened={true}/>\n        <MapRegionIndicator region={region}/> */}\n      {/* </GoogleMapReact> */}\n      <GoogleMap\n        defaultZoom={8}\n        defaultCenter={{ lat: -34.397, lng: 150.644 }}\n      >\n        <Marker position={{ lat: -34.397, lng: 150.644 }} />\n      </GoogleMap>\n      \n    </div>\n  );\n}\n\nexport default MapScreen;"]},"metadata":{},"sourceType":"module"}