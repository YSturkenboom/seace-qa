{"ast":null,"code":"var _jsxFileName=\"/home/yuri/Freelance/Clients/Cheil/seace-qa/src/components/MapFilter.tsx\";import React,{useState,useEffect}from'react';import{Button,Radio,Card,RadioGroup,FormControlLabel}from'@material-ui/core';import{Formik,Form,Field}from'formik';import{FilterTextField}from'./form/FilterTextField';import{LocationCard}from'./form/LocationCard';import{Search}from'@material-ui/icons';const distanceToTarget=(location,locationTarget)=>{// TODO: Replace with maps distance\nvar a=location.lat-locationTarget.lat;var b=location.lon-locationTarget.lon;return Math.sqrt(a*a+b*b);};const filterCompanies=(companies,distance,searchLocation,storeType,productType,searchType)=>{// Filter on type first for performance\nlet filteredCompanies=companies;if(searchType==='advanced'){if(storeType==='For home'||storeType==='For business'){filteredCompanies=filteredCompanies.filter(c=>c['Installer Type']===storeType||c['Installer Type']==='For home & business');}if(productType==='Cooling'||productType==='Heating'){filteredCompanies=filteredCompanies.filter(c=>c['Product Type']===productType||c['Product Type']==='Cooling & Heating');}}// Calculate distance\nfilteredCompanies=filteredCompanies.map(c=>{console.log({storeType:storeType,type:c['Installer Type']});console.log({lat:parseFloat(String(c['Latitude'])),lon:parseFloat(String(c['Longitude']))});const location={lat:parseFloat(String(c['Latitude'])),lon:parseFloat(String(c['Longitude']))};c.distanceToTarget=distanceToTarget(location,searchLocation);return c;});// Filter on distance\nreturn filteredCompanies.filter(c=>c.distanceToTarget<=distance);};export const Filter=({onSubmit,loading,companies,searchLocation,mapRef,setActivePlace})=>{const[distance,setDistance]=useState(10);const[filteredCompanies,setFilteredCompanies]=useState(companies);const[searchType,setSearchType]=useState('simple');const[storeTypeDropDownIsOpen,setStoreTypeDropDownIsOpen]=useState(true);const[productTypeDropDownIsOpen,setProductTypeDropDownIsOpen]=useState(true);const[storeType,setStoreType]=useState('For home & business');const[productType,setProductType]=useState('Cooling & Heating');// Every filter change, or when companies load in\nuseEffect(()=>{if(companies&&searchLocation){setFilteredCompanies(filterCompanies(companies,distance,searchLocation,storeType,productType,searchType));}},[distance,searchLocation,companies,storeType,searchType,productType]);return/*#__PURE__*/React.createElement(Card,{raised:true,className:\"map-search-box\",__self:this,__source:{fileName:_jsxFileName,lineNumber:80,columnNumber:9}},/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-header\",__self:this,__source:{fileName:_jsxFileName,lineNumber:81,columnNumber:13}},/*#__PURE__*/React.createElement(\"h1\",{className:\"map-search-box-heading\",__self:this,__source:{fileName:_jsxFileName,lineNumber:82,columnNumber:17}},\"Installer Locator\"),/*#__PURE__*/React.createElement(\"p\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:83,columnNumber:17}},\"Information on this page is subject to change without prior notice. Please contact the installer directly for up to date information.\")),/*#__PURE__*/React.createElement(\"div\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:13}},/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-form-searchtype\",__self:this,__source:{fileName:_jsxFileName,lineNumber:87,columnNumber:17}},/*#__PURE__*/React.createElement(Button,{onClick:()=>setSearchType(\"simple\"),className:\"map-search-box-form-distance-btn\"+(searchType==='simple'?\" btn-active\":''),__self:this,__source:{fileName:_jsxFileName,lineNumber:88,columnNumber:21}},\"Search\"),/*#__PURE__*/React.createElement(Button,{onClick:()=>setSearchType(\"advanced\"),className:\"map-search-box-form-distance-btn\"+(searchType!=='simple'?\" btn-active\":''),__self:this,__source:{fileName:_jsxFileName,lineNumber:94,columnNumber:21}},\"Advanced Search\")),/*#__PURE__*/React.createElement(Formik,{initialValues:{address:\"\",distanceInKilometers:10},onSubmit:onSubmit,__self:this,__source:{fileName:_jsxFileName,lineNumber:102,columnNumber:17}},({values})=>/*#__PURE__*/React.createElement(Form,{className:\"map-search-box-form\",__self:this,__source:{fileName:_jsxFileName,lineNumber:110,columnNumber:25}},/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-form-search\",__self:this,__source:{fileName:_jsxFileName,lineNumber:111,columnNumber:33}},/*#__PURE__*/React.createElement(Field,{name:\"address\",placeholder:\"Address or post code...\",component:FilterTextField,className:\"map-search-box-form-search\",__self:this,__source:{fileName:_jsxFileName,lineNumber:112,columnNumber:37}}),/*#__PURE__*/React.createElement(Button,{type:\"submit\",__self:this,__source:{fileName:_jsxFileName,lineNumber:118,columnNumber:37}},/*#__PURE__*/React.createElement(Search,{__self:this,__source:{fileName:_jsxFileName,lineNumber:119,columnNumber:41}},\" \"))),/*#__PURE__*/React.createElement(RadioGroup,{row:true,onChange:e=>setDistance(parseInt(e.target.value)),\"aria-label\":\"position\",name:\"position\",defaultValue:\"top\",className:\"map-search-box-form-distance\",__self:this,__source:{fileName:_jsxFileName,lineNumber:123,columnNumber:33}},/*#__PURE__*/React.createElement(FormControlLabel,{value:\"0.1\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:126,columnNumber:50}}),label:\"1 mile\",labelPlacement:\"top\",__self:this,__source:{fileName:_jsxFileName,lineNumber:124,columnNumber:37}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"2\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:132,columnNumber:50}}),label:\"2 miles\",labelPlacement:\"top\",__self:this,__source:{fileName:_jsxFileName,lineNumber:130,columnNumber:37}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"5\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:138,columnNumber:50}}),label:\"5 miles\",labelPlacement:\"top\",__self:this,__source:{fileName:_jsxFileName,lineNumber:136,columnNumber:37}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"10\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:144,columnNumber:50}}),label:\"10 miles\",labelPlacement:\"top\",__self:this,__source:{fileName:_jsxFileName,lineNumber:142,columnNumber:37}}))))),searchType==='advanced'&&/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-advanced\",__self:this,__source:{fileName:_jsxFileName,lineNumber:156,columnNumber:17}},/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-advanced-header\",__self:this,__source:{fileName:_jsxFileName,lineNumber:157,columnNumber:21}},/*#__PURE__*/React.createElement(\"p\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:158,columnNumber:25}},\"Store Type\"),/*#__PURE__*/React.createElement(Button,{onClick:()=>setStoreTypeDropDownIsOpen(!storeTypeDropDownIsOpen),__self:this,__source:{fileName:_jsxFileName,lineNumber:159,columnNumber:25}},storeTypeDropDownIsOpen?'-':'+')),storeTypeDropDownIsOpen&&/*#__PURE__*/React.createElement(RadioGroup,{onChange:e=>setStoreType(e.target.value),\"aria-label\":\"position\",name:\"position\",defaultValue:\"For home and business\",__self:this,__source:{fileName:_jsxFileName,lineNumber:164,columnNumber:25}},/*#__PURE__*/React.createElement(FormControlLabel,{value:\"For home\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:167,columnNumber:42}}),label:\"For Home\",labelPlacement:\"end\",__self:this,__source:{fileName:_jsxFileName,lineNumber:165,columnNumber:29}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"For business\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:173,columnNumber:42}}),label:\"For Business\",labelPlacement:\"end\",__self:this,__source:{fileName:_jsxFileName,lineNumber:171,columnNumber:29}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"For home & business\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:179,columnNumber:42}}),label:\"For Home & Business\",labelPlacement:\"end\",__self:this,__source:{fileName:_jsxFileName,lineNumber:177,columnNumber:29}})),/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-advanced-header\",__self:this,__source:{fileName:_jsxFileName,lineNumber:185,columnNumber:21}},/*#__PURE__*/React.createElement(\"p\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:186,columnNumber:25}},\"Product Type\"),/*#__PURE__*/React.createElement(Button,{onClick:()=>setProductTypeDropDownIsOpen(!productTypeDropDownIsOpen),__self:this,__source:{fileName:_jsxFileName,lineNumber:187,columnNumber:25}},productTypeDropDownIsOpen?'-':'+')),productTypeDropDownIsOpen&&/*#__PURE__*/React.createElement(RadioGroup,{onChange:e=>setProductType(e.target.value),\"aria-label\":\"position\",name:\"position\",defaultValue:\"Cooling & Heating\",__self:this,__source:{fileName:_jsxFileName,lineNumber:192,columnNumber:25}},/*#__PURE__*/React.createElement(FormControlLabel,{value:\"Cooling\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:195,columnNumber:42}}),label:\"Cooling\",labelPlacement:\"end\",__self:this,__source:{fileName:_jsxFileName,lineNumber:193,columnNumber:29}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"Heating\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:201,columnNumber:42}}),label:\"Heating\",labelPlacement:\"end\",__self:this,__source:{fileName:_jsxFileName,lineNumber:199,columnNumber:29}}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"Cooling & Heating\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",__self:this,__source:{fileName:_jsxFileName,lineNumber:207,columnNumber:42}}),label:\"Cooling & Heating\",labelPlacement:\"end\",__self:this,__source:{fileName:_jsxFileName,lineNumber:205,columnNumber:29}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"map-search-box-footer\",__self:this,__source:{fileName:_jsxFileName,lineNumber:216,columnNumber:13}},loading?'Loading...':/*#__PURE__*/React.createElement(\"div\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:220,columnNumber:21}},filteredCompanies?filteredCompanies.map(c=>/*#__PURE__*/React.createElement(LocationCard,{name:c['Company name'],telephone:c['Phone number'],address:c['Street Address'],distance:c.distanceToTarget,mapRef:mapRef,lat:parseFloat(String(c['Latitude'])),lon:parseFloat(String(c['Longitude'])),setActivePlace:setActivePlace,installerType:c['Installer Type'],__self:this,__source:{fileName:_jsxFileName,lineNumber:222,columnNumber:29}})):\"No installers found. Please broaden your search criteria\")));};/* <p>Text</p>\n            <div>\n                <button onClick={}>Search</button>\n                <button>Advanced search</button>\n            </div>\n            <input onChange={(e) => setQuery(e.target.value)} value={query} placeholder={'Postcode or address...'} /> */","map":{"version":3,"sources":["/home/yuri/Freelance/Clients/Cheil/seace-qa/src/components/MapFilter.tsx"],"names":["React","useState","useEffect","Button","Radio","Card","RadioGroup","FormControlLabel","Formik","Form","Field","FilterTextField","LocationCard","Search","distanceToTarget","location","locationTarget","a","lat","b","lon","Math","sqrt","filterCompanies","companies","distance","searchLocation","storeType","productType","searchType","filteredCompanies","filter","c","map","console","log","type","parseFloat","String","Filter","onSubmit","loading","mapRef","setActivePlace","setDistance","setFilteredCompanies","setSearchType","storeTypeDropDownIsOpen","setStoreTypeDropDownIsOpen","productTypeDropDownIsOpen","setProductTypeDropDownIsOpen","setStoreType","setProductType","address","distanceInKilometers","values","e","parseInt","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Button, Radio, Card, RadioGroup, FormControlLabel } from '@material-ui/core';\nimport { Formik, Form, Field } from 'formik';\nimport { FilterTextField } from './form/FilterTextField';\nimport { LocationCard } from './form/LocationCard';\nimport { Search } from '@material-ui/icons';\nimport { CompanyLayout, LocationLayout } from '../interfaces';\nimport { GoogleMap } from \"react-google-maps\"\n\n\ninterface Values {\n    address: string;\n    distanceInKilometers: number;\n}\n  \ninterface Props {\n    onSubmit: (values: Values) => void;\n    companies: Array<CompanyLayout> | null;\n    loading: boolean;\n    searchLocation: LocationLayout | null;\n    mapRef: React.RefObject<GoogleMap>;\n    setActivePlace: React.Dispatch<React.SetStateAction<string | null | undefined>>;\n}\n\nconst distanceToTarget = (location: LocationLayout, locationTarget: LocationLayout) => {\n\n    // TODO: Replace with maps distance\n    var a = location.lat - locationTarget.lat;\n    var b = location.lon - locationTarget.lon;    \n    return Math.sqrt( a*a + b*b );\n};\n\nconst filterCompanies = (companies: Array<CompanyLayout>, distance: number, searchLocation: LocationLayout, storeType: string, productType: string, searchType: string): Array<CompanyLayout> => {\n    // Filter on type first for performance\n    let filteredCompanies = companies\n    if (searchType === 'advanced') {\n        if (storeType === 'For home' || storeType === 'For business') {\n            filteredCompanies =  filteredCompanies.filter(c => c['Installer Type'] === storeType || c['Installer Type'] === 'For home & business');\n        }\n        if (productType === 'Cooling' || productType === 'Heating') {\n            filteredCompanies =  filteredCompanies.filter(c => c['Product Type'] === productType || c['Product Type'] === 'Cooling & Heating');\n        }\n    }\n\n    // Calculate distance\n    filteredCompanies = filteredCompanies.map(c => {\n        console.log({storeType: storeType, type: c['Installer Type']});\n        console.log({lat: parseFloat(String(c['Latitude'])), lon: parseFloat(String(c['Longitude']))});\n        \n        const location = {\n            lat: parseFloat(String(c['Latitude'])),\n            lon: parseFloat(String(c['Longitude']))\n        }\n        c.distanceToTarget = distanceToTarget(location, searchLocation);\n        return c;\n    })\n\n    // Filter on distance\n\n    return filteredCompanies.filter(c => c.distanceToTarget <= distance);\n}\n\nexport const Filter: React.FC<Props> = ({ onSubmit, loading, companies, searchLocation, mapRef, setActivePlace }) => {\n    const [distance, setDistance] = useState<number>(10);\n    const [filteredCompanies, setFilteredCompanies] = useState(companies);\n    const [searchType, setSearchType] = useState<'simple' | 'advanced'>('simple');\n    const [storeTypeDropDownIsOpen, setStoreTypeDropDownIsOpen] = useState<boolean>(true);\n    const [productTypeDropDownIsOpen, setProductTypeDropDownIsOpen] = useState<boolean>(true);\n    const [storeType, setStoreType] = useState<string>('For home & business')\n    const [productType, setProductType] = useState<string>('Cooling & Heating');\n\n    // Every filter change, or when companies load in\n    useEffect(() => {\n        if (companies && searchLocation) {\n            setFilteredCompanies(filterCompanies(companies, distance, searchLocation, storeType, productType, searchType));\n        }\n    }, [distance, searchLocation, companies, storeType, searchType, productType]);\n\n    return (\n        <Card raised className=\"map-search-box\">\n            <div className=\"map-search-box-header\">\n                <h1 className=\"map-search-box-heading\">Installer Locator</h1>\n                <p>Information on this page is subject to change without prior notice. Please contact the installer directly for up to date information.</p>\n            </div>\n            \n            <div>\n                <div className=\"map-search-box-form-searchtype\">\n                    <Button \n                        onClick={() => setSearchType(\"simple\")}\n                        className={\"map-search-box-form-distance-btn\" + (searchType === 'simple' ? \" btn-active\" : '')}\n                    >\n                        Search\n                    </Button>\n                    <Button\n                        onClick={() => setSearchType(\"advanced\")}\n                        className={\"map-search-box-form-distance-btn\" + (searchType !== 'simple' ? \" btn-active\" : '')}\n                    >\n                        Advanced Search\n                    </Button>\n                </div>\n\n                <Formik \n                    initialValues={{\n                        address: \"\",\n                        distanceInKilometers: 10,\n                    }}\n                    onSubmit={onSubmit}\n                >\n                    {({ values }) => (\n                        <Form className=\"map-search-box-form\">\n                                <div className=\"map-search-box-form-search\">\n                                    <Field\n                                        name=\"address\"\n                                        placeholder=\"Address or post code...\"\n                                        component={FilterTextField}\n                                        className=\"map-search-box-form-search\"\n                                    />\n                                    <Button type=\"submit\">\n                                        <Search> </Search>\n                                    </Button>\n                                </div>\n\n                                <RadioGroup row onChange={e => setDistance(parseInt(e.target.value))}  aria-label=\"position\" name=\"position\" defaultValue=\"top\" className=\"map-search-box-form-distance\">\n                                    <FormControlLabel\n                                        value=\"0.1\"\n                                        control={<Radio color=\"primary\" />}\n                                        label=\"1 mile\"\n                                        labelPlacement=\"top\"\n                                    />\n                                    <FormControlLabel\n                                        value=\"2\"\n                                        control={<Radio color=\"primary\" />}\n                                        label=\"2 miles\"\n                                        labelPlacement=\"top\"\n                                    />\n                                    <FormControlLabel\n                                        value=\"5\"\n                                        control={<Radio color=\"primary\" />}\n                                        label=\"5 miles\"\n                                        labelPlacement=\"top\"\n                                    />\n                                    <FormControlLabel\n                                        value=\"10\"\n                                        control={<Radio color=\"primary\" />}\n                                        label=\"10 miles\"\n                                        labelPlacement=\"top\"\n                                    />\n                                </RadioGroup>\n                        </Form>\n                    )}\n                    \n                </Formik>\n            </div>\n\n            {searchType === 'advanced' &&\n                <div className=\"map-search-box-advanced\">\n                    <div className=\"map-search-box-advanced-header\">\n                        <p>Store Type</p>\n                        <Button onClick={() => setStoreTypeDropDownIsOpen(!storeTypeDropDownIsOpen)}>\n                            {storeTypeDropDownIsOpen ? '-' : '+'}\n                        </Button>\n                    </div>\n                    {storeTypeDropDownIsOpen &&\n                        <RadioGroup onChange={e => setStoreType(e.target.value)} aria-label=\"position\" name=\"position\" defaultValue=\"For home and business\">\n                            <FormControlLabel\n                                value=\"For home\"\n                                control={<Radio color=\"primary\" />}\n                                label=\"For Home\"\n                                labelPlacement=\"end\"\n                            />\n                            <FormControlLabel\n                                value=\"For business\"\n                                control={<Radio color=\"primary\" />}\n                                label=\"For Business\"\n                                labelPlacement=\"end\"\n                            />\n                            <FormControlLabel\n                                value='For home & business'\n                                control={<Radio color=\"primary\" />}\n                                label=\"For Home & Business\"\n                                labelPlacement=\"end\"\n                            />\n                        </RadioGroup>\n                    }\n                    <div className=\"map-search-box-advanced-header\">\n                        <p>Product Type</p>\n                        <Button onClick={() => setProductTypeDropDownIsOpen(!productTypeDropDownIsOpen)}>\n                            {productTypeDropDownIsOpen ? '-' : '+'}\n                        </Button>\n                    </div>\n                    {productTypeDropDownIsOpen &&\n                        <RadioGroup onChange={e => setProductType(e.target.value)} aria-label=\"position\" name=\"position\" defaultValue=\"Cooling & Heating\">\n                            <FormControlLabel\n                                value=\"Cooling\"\n                                control={<Radio color=\"primary\" />}\n                                label=\"Cooling\"\n                                labelPlacement=\"end\"\n                            />\n                            <FormControlLabel\n                                value=\"Heating\"\n                                control={<Radio color=\"primary\" />}\n                                label=\"Heating\"\n                                labelPlacement=\"end\"\n                            />\n                            <FormControlLabel\n                                value='Cooling & Heating'\n                                control={<Radio color=\"primary\" />}\n                                label=\"Cooling & Heating\"\n                                labelPlacement=\"end\"\n                            />\n                        </RadioGroup>\n                    }\n            </div>\n            }\n\n            <div className=\"map-search-box-footer\">\n                {loading ? (\n                    'Loading...'\n                ) : (\n                    <div>\n                        {filteredCompanies ? filteredCompanies.map(c =>\n                            <LocationCard\n                                name={c['Company name']}\n                                telephone={c['Phone number']}\n                                address={c['Street Address']}\n                                distance={c.distanceToTarget}\n                                mapRef={mapRef}\n                                lat={parseFloat(String(c['Latitude']))}\n                                lon={parseFloat(String(c['Longitude']))}\n                                setActivePlace={setActivePlace}\n                                installerType={c['Installer Type']}\n                            />\n                        ) : \"No installers found. Please broaden your search criteria\"}\n                    </div>\n                )}\n            </div>\n        </Card>\n    );\n}\n\n            /* <p>Text</p>\n            <div>\n                <button onClick={}>Search</button>\n                <button>Advanced search</button>\n            </div>\n            <input onChange={(e) => setQuery(e.target.value)} value={query} placeholder={'Postcode or address...'} /> */"]},"metadata":{},"sourceType":"module"}